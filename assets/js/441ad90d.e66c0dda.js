"use strict";(self.webpackChunk_playcanvas_blog=self.webpackChunk_playcanvas_blog||[]).push([[22836],{93086:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var s=n(74848),a=n(28453);const i={authors:"nathan",slug:"playhack-december-creating-presents",title:"PLAYHACK December - Creating Presents"},r=void 0,o={permalink:"/playhack-december-creating-presents",editUrl:"https://github.com/playcanvas/blog/tree/main/blog/2014-12-12-playhack-december-creating-presents.md",source:"@site/blog/2014-12-12-playhack-december-creating-presents.md",title:"PLAYHACK December - Creating Presents",description:"**PLAYHACK** is our fun monthly game building session. Throughout the month I\u2019ll be posting tips and tricks to help you get a game made by the end of the month.\xa0Don\u2019t forget, these are just examples. You can make **any** game you like. Read more about this month\u2019s PLAYHACK.",date:"2014-12-12T00:00:00.000Z",tags:[],readingTime:6.54,hasTruncateMarker:!0,authors:[{name:"Nathan",page:{permalink:"/authors/nathan"},key:"nathan"}],frontMatter:{authors:"nathan",slug:"playhack-december-creating-presents",title:"PLAYHACK December - Creating Presents"},unlisted:!1,prevItem:{title:"PLAYHACK December - Collecting Presents",permalink:"/playhack-december-collecting-presents"},nextItem:{title:"Physically Based Rendering comes to WebGL",permalink:"/physically-based-rendering-comes-to-webgl"}},h={authorsImageUrls:[void 0]},c=[{value:"Moving the Presents",id:"moving-the-presents",level:3},{value:"Creating Many Presents",id:"creating-many-presents",level:3},{value:"Housekeeping",id:"housekeeping",level:3}];function l(e){const t={a:"a",code:"code",em:"em",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:(0,s.jsxs)(t.em,{children:[(0,s.jsx)(t.strong,{children:"PLAYHACK"})," is our fun monthly game building session. Throughout the month I\u2019ll be posting tips and tricks to help you get a game made by the end of the month.\xa0Don\u2019t forget, these are just examples. You can make ",(0,s.jsx)(t.strong,{children:"any"})," game you like. ",(0,s.jsx)(t.a,{href:"https://blog.playcanvas.com/playhack-december-jolly-santa/",children:"Read more"})," about this month\u2019s PLAYHACK."]})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"PLAYHACK Logo",src:n(6694).A+"",width:"603",height:"218"})}),"\n",(0,s.jsxs)(t.p,{children:["We'll be following on from ",(0,s.jsx)(t.a,{href:"https://blog.playcanvas.com/playhack-december-player-character/",children:"last time's tutorial"})," this time, so make sure you've followed that one before attempting this!"]}),"\n",(0,s.jsx)("div",{className:"iframe-container",children:(0,s.jsx)("iframe",{loading:"lazy",src:"https://playcanv.as/b/eyPboW2T/",title:"360 lookaround camera",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"autoplay",allowfullscreen:"true",allowvr:"",scrolling:"no",frameborder:"0"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Use W and S to move the sleigh."})}),"\n",(0,s.jsx)(t.p,{children:"In this tutorial, we're going to program the gifts\xa0that will come in from the right for Santa to collect."}),"\n",(0,s.jsx)(t.h3,{id:"moving-the-presents",children:"Moving the Presents"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(74624).A+"",children:(0,s.jsx)(t.img,{alt:"Santa and the Present",src:n(53934).A+"",width:"862",height:"469"})})}),"\n",(0,s.jsx)(t.p,{children:"To start with, we'll need to create a script that will make the presents move across the screen towards Santa. We're also going to make the presents rotate, just because it looks nice. To do that, we need to attach a new script to the Gift entity, just like we did last time with Santa. Call it something like 'gift_controller'."}),"\n",(0,s.jsx)(t.p,{children:"Now, let's think about what we need - just like with Santa's script, we're going to need the speed we want the presents to move, and we'll also need the speed we want the presents to rotate. So let's make two attributes for that:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:'pc.script.attribute("speed", "number", 10);\npc.script.attribute("rotspeed", "number", 90);\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Put them at the top of the script like before (remember to do ",(0,s.jsx)(t.em,{children:"Entity > Refresh Script Attributes"})," when you come to test!)."]}),"\n",(0,s.jsx)(t.p,{children:"Now we need to move the gift every frame. This is again, very similar to the Santa movement code:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"// Called every frame, dt is time in seconds since last update\nupdate: function (dt) {\n    this.entity.translate(0, 0, -this.speed*dt);\n    this.entity.rotate(0, this.rotspeed*dt, 0);\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["To move the present, we use the ",(0,s.jsx)(t.code,{children:"entity.translate"})," function, as before. To rotate, we use the ",(0,s.jsx)(t.code,{children:"entity.rotate"})," function, which as its name suggests, rotates the present by a certain amount."]}),"\n",(0,s.jsxs)(t.p,{children:["If you launch the game (remembering to do ",(0,s.jsx)(t.em,{children:"Entity > Refresh Script Attributes"}),"!) then the present in the middle of the screen should hopefully move offscreen whilst rotating. Success!"]}),"\n",(0,s.jsx)(t.h3,{id:"creating-many-presents",children:"Creating Many Presents"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(97974).A+"",children:(0,s.jsx)(t.img,{alt:"Many Presents",src:n(8).A+"",width:"1440",height:"784"})})}),"\n",(0,s.jsx)(t.p,{children:"Now, we'll need to create a script that will create presents every so often off the right hand edge of the screen. This might seem odd - up until now we've only created scripts that do things to entities already on screen. To do this, we're going to attach a script to the root entity of the game - which is the entity called \"Santa\" in the pack explorer. Add a script to the root entity called 'gift_creator'."}),"\n",(0,s.jsxs)(t.p,{children:["So, let's think about how to go about this. We've got quite a few things to think about. Firstly, how do we add new presents? We can achieve this by cloning the gift that's already on screen. To do this, we need a reference to that present. In the ",(0,s.jsx)(t.code,{children:"initialize"})," method, add the following code:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:'this.gift = context.root.findByName("Gift");\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Now we have a variable, ",(0,s.jsx)(t.code,{children:"this.gift"}),", which contains the gift that is on screen. We'll get on to how to clone it in a second."]}),"\n",(0,s.jsx)(t.p,{children:"What else do we have to think about? Two main things - where we want to add the new presents, and how often we want to add them. We're going to have an element of randomness to where and when we add the presents - we want the presents to come in from the right at different heights, and we also don't want the presents to come in like clockwork - we want to keep the player on his toes and have them spawn with slightly different amounts of time between them."}),"\n",(0,s.jsx)(t.p,{children:"We'll add some new attributes so we can easily test and change these things:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:'pc.script.attribute("avgPresentTime", "number", 0.75);\npc.script.attribute("presentRange", "number", 0.5);\npc.script.attribute("maxY", "number", 8);\npc.script.attribute("offscreenZ", "number", 20);\n'})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"avgPresentTime"})," is the average amount of time between each present coming spawning,\xa0and ",(0,s.jsx)(t.code,{children:"presentRange"})," is how many seconds around the average time presents could come in. ",(0,s.jsx)(t.code,{children:"maxY"})," is the highest position a present could come in at, and ",(0,s.jsx)(t.code,{children:"offscreenZ"})," is the z position we are going to create our new presents at."]}),"\n",(0,s.jsx)(t.p,{children:"So, now we've got all these attributes, what do we need to do? We need some sort of timer than allows us to check whether or not to add a new present yet. Let's add some variables so we can do that:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:'initialize: function () {\n    this.gift = context.root.findByName("Gift");\n    this.presentTimer = 0;\n    this.presentTimeToGet = 0;\n},\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The first line we added earlier - but we've now got two new variables, ",(0,s.jsx)(t.code,{children:"presentTimer"})," and ",(0,s.jsx)(t.code,{children:"presentTimeToGet"}),". We will use ",(0,s.jsx)(t.code,{children:"presentTimer"})," to count how long it's been since we last added a present, and ",(0,s.jsx)(t.code,{children:"presentTimeToGet"})," will be how long we need to wait until adding the next present."]}),"\n",(0,s.jsxs)(t.p,{children:["So, we now know that every frame, we need to increment ",(0,s.jsx)(t.code,{children:"this.presentTimer"})," by the amount of time passed since the last frame - which is helpfully passed into the ",(0,s.jsx)(t.code,{children:"update"})," function as the variable ",(0,s.jsx)(t.code,{children:"dt"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"update: function (dt) {\n    this.presentTimer += dt;\n    if(this.presentTimer >= this.presentTimeToGet) {\n        //Create a new gift\n    }\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"So, now we know when we're adding a new gift. To add a new gift to the game, we can use the following code:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"var newGift = this.gift.clone();\nnewGift.enabled = true;\ncontext.root.addChild(newGift);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This clones ",(0,s.jsx)(t.code,{children:"this.gift"}),", and stores the new gift in the variable ",(0,s.jsx)(t.code,{children:"newGift"}),". We then have to do two things to actually get the gift in game - we have to enable it, and then add it to the entity hierarchy."]}),"\n",(0,s.jsx)(t.p,{children:"Now we have a new gift in the game - however, it's at the same position as the first gift! That's not good. We want it to be offscreen at a random height to start with! Let's fix that."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"// Set its position correctly\nvar rand = Math.random() * 2 - 1;\nvar newY = rand * maxY;\nnewGift.setPosition(0, newY, this.offscreenZ);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["There's a few new things going on here! First, let's look at the randomness. ",(0,s.jsx)(t.code,{children:"Math.random()"})," is a built in JavaScript function that returns a random number from 0 to 1. We, however, want a random number from ",(0,s.jsx)(t.code,{children:"maxY"})," to negative ",(0,s.jsx)(t.code,{children:"maxY"}),". To achieve this, we multiply our random number by 2 (giving us a number between 0 and 2), then take away 1 (between -1 and 1), then multiply it by maxY (between ",(0,s.jsx)(t.code,{children:"-maxY"})," and ",(0,s.jsx)(t.code,{children:"maxY"}),"). Once we have the random ",(0,s.jsx)(t.code,{children:"newY"})," position, we can set the position of the ",(0,s.jsx)(t.code,{children:"newGift"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Now, we're very almost done. However, we've now added a present, so we need to reset ",(0,s.jsx)(t.code,{children:"presentTimer"})," to 0, as it's been 0 seconds since we added a present! We also want to change ",(0,s.jsx)(t.code,{children:"presentTimeToGet"}),", as we want to wait a slightly different length of time before adding another present."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"// And reset the timer\nthis.presentTimer = 0;\nthis.presentTimeToGet = this.avgPresentTime + this.presentRange * (Math.random() - 0.5);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["We use ",(0,s.jsx)(t.code,{children:"Math.random()"})," again here to get the time before we want to add another present. This gives us a number that will be no more than half of ",(0,s.jsx)(t.code,{children:"presentRange"})," away from ",(0,s.jsx)(t.code,{children:"avgPresentTime"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["That should be it! Test your code (REMEMBER ",(0,s.jsx)(t.em,{children:"Entity Menu > Refresh Script Attributes"}),"), and presents should start coming in from the right. Perfect!"]}),"\n",(0,s.jsx)(t.h3,{id:"housekeeping",children:"Housekeeping"}),"\n",(0,s.jsx)(t.p,{children:"One last thing - we've left the sack floating in the middle of the screen, and we don't really want the first present to start in the middle of the screen either.\xa0To fix this, simply select the gift/sack, and uncheck the 'Enabled' attribute. That's it! The initial sack and gift will no longer\xa0show up in the editor or when you test the game."}),"\n",(0,s.jsxs)(t.p,{children:["Next time, we'll be looking at ",(0,s.jsx)(t.a,{href:"https://developer.playcanvas.com/tutorials/collision-and-triggers/",children:"Trigger Volumes"}),", which will allow us to have Santa actually collect the presents when he touches them."]})]})}function d(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},97974:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/files/Screen-Shot-2014-11-24-at-15.58.42-0fa83dd1712c5252016697245a7dc84d.png"},74624:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/files/editor-santa-and-present-582b7c8b13122c206cfa31a24978f695.png"},8:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Screen-Shot-2014-11-24-at-15.58.42-0fa83dd1712c5252016697245a7dc84d.png"},53934:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/editor-santa-and-present-582b7c8b13122c206cfa31a24978f695.png"},6694:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/playhack-logo-xmas-451ccd5e2d37685bc0f90e7e5a066b00.jpg"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var s=n(96540);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);