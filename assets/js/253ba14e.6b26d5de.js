"use strict";(self.webpackChunk_playcanvas_blog=self.webpackChunk_playcanvas_blog||[]).push([[1168],{6694:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/playhack-logo-xmas-451ccd5e2d37685bc0f90e7e5a066b00.jpg"},8e3:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>h});var a=n(49773),o=n(74848),s=n(28453);const i={authors:"nathan",slug:"playhack-december-player-character",title:"PLAYHACK December - Player Character"},r=void 0,l={authorsImageUrls:[void 0]},h=[{value:"Camera",id:"camera",level:2},{value:"Player",id:"player",level:2},{value:"Player Controller",id:"player-controller",level:2},{value:"Keyboard Controls",id:"keyboard-controls",level:2},{value:"Mouse Controls",id:"mouse-controls",level:2}];function c(e){const t={a:"a",code:"code",em:"em",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:(0,o.jsxs)(t.em,{children:[(0,o.jsx)(t.strong,{children:"PLAYHACK"})," is our fun monthly game building session. Throughout the month I'll be posting tips and tricks to help you get a game made by the end of the month.\xa0Don\u2019t forget, these are just examples. You can make ",(0,o.jsx)(t.strong,{children:"any"})," game you like. ",(0,o.jsx)(t.a,{href:"https://blog.playcanvas.com/playhack-december-jolly-santa/",children:"Read more"})," about this month's PLAYHACK."]})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"PLAYHACK Logo",src:n(6694).A+"",width:"603",height:"218"})}),"\n",(0,o.jsx)("div",{className:"iframe-container",children:(0,o.jsx)("iframe",{loading:"lazy",src:"https://playcanv.as/b/WbIFTpdn/",title:"360 lookaround camera",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"autoplay",allowfullscreen:"true",allowvr:"",scrolling:"no",frameborder:"0"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"Use\xa0W and S to move the sleigh. Press SPACE to switch to mouse control."})}),"\n",(0,o.jsx)(t.p,{children:"In the coming weeks, I'll be taking you through how to make a complete game in PlayCanvas - from very beginning to very end, with only basic programming knowledge required!"}),"\n",(0,o.jsx)(t.p,{children:"We're going to be making a side-scrolling endless runner game, where Santa must pick up presents and avoid various things to deliver presents on time! However, the techniques we'll be using will be applicable to many kinds of games."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Santa",src:n(39914).A+"",width:"1113",height:"727"})}),"\n",(0,o.jsxs)(t.p,{children:["To follow along with this tutorial, fork the ",(0,o.jsx)(t.a,{href:"https://playcanvas.com/project/333365/overview/playhack-dec-14",children:"PLAYHACK December project"}),"\xa0to get started. To see what we\u2019ll be making this time, ",(0,o.jsx)(t.a,{href:"https://playcanvas.com/project/333872/overview/playhack_tut1",children:"look here"}),". Or just check out the embedded app\xa0above."]}),"\n",(0,o.jsx)(t.p,{children:"So you've forked the repository and got it open in the editor. We're going to need to make a few changes to start making our game."}),"\n",(0,o.jsx)(t.h2,{id:"camera",children:"Camera"}),"\n",(0,o.jsx)(t.p,{children:'Firstly, the camera. There are two camera types in PlayCanvas - Perspective and Orthographic. Perspective is what you want for most 3D games \u2013 it\u2019s how things look in life.\nHowever, our game is pretty much 2D - which means an Orthographic projection would be best for us. To make the switch, select the Camera in the Pack Explorer, then in the Attribute Editor on the right, change Projection from "Perspective" to "Orthographic."'}),"\n",(0,o.jsx)(t.p,{children:"If you test now by pressing the Launch button, you'll see that Santa is tiny in the middle of the screen! That's not what we want. We can fix this by reducing the Ortho Height attribute of the camera. Reduce it from 100 down to about 10, and now check the game. Santa's now a much better size!"}),"\n",(0,o.jsx)(t.h2,{id:"player",children:"Player"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(87562).A+"",children:(0,o.jsx)(t.img,{alt:"Santa",src:n(54080).A+"",width:"600",height:"330"})})}),"\n",(0,o.jsx)(t.p,{children:"Now, we want Santa to start on the left of the screen, looking right. To make things easier for us, we'll align our camera along the Z-axis so that moving things around on screen becomes easier for us later."}),"\n",(0,o.jsx)(t.p,{children:"To do that, set the camera position to 0, 0, 10, and the rotation to 0, 0, 0. Santa should now be looking right at the camera in the middle of the screen. You can use the rotate and translate tools in the editor to move him to the right place, or you can select Santa_sleigh from the Pack Explorer and set his position to -17, 0, 0 and his rotation to 0, 90, 0. Great! Take a look at the game again. Santa's now in the right place, facing the right way. Lovely."}),"\n",(0,o.jsx)(t.p,{children:"Let's get Santa moving. We're going to create two ways for Santa to move - by mouse and by keyboard. Let's create a new script, called Santa_Controller, and attach it to the Santa_sleigh entity we have."}),"\n",(0,o.jsx)(t.p,{children:'To do this, right click on Santa_sleigh in the Pack Explorer, and select Add Component > Script. Now we can attach scripts to Santa. To attach a new script to Santa, simply type the name of the new script (in our case, "Santa_Controller") in the URL box of the Script Attribute we just added to Santa.'}),"\n",(0,o.jsx)(t.h2,{id:"player-controller",children:"Player Controller"}),"\n",(0,o.jsx)(t.p,{children:"Now we've created the new script and attached it to Santa, let's edit it and make Santa do something! Click on the blue Santa_Controller.js link that should have appeared below the URL box to get editing!"}),"\n",(0,o.jsx)(t.p,{children:"You'll be greeted by a new script that should look like this:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"pc.script.create('Santa_Controller', function (context) {\n    // Creates a new Santa_Controller instance\n    var Santa_Controller = function (entity) {\n        this.entity = entity;\n    };\n\n    Santa_Controller.prototype = {\n        // Called once after all resources are loaded\n        initialize: function () {\n        },\n\n        // Called every frame, dt is time in seconds since last update\n        update: function (dt) {\n        }\n    };\n\n    return Santa_Controller;\n});\n"})}),"\n",(0,o.jsx)(t.p,{children:"Let\u2019s think about what we need to do to make Santa move up and down. Well, we\u2019ll need the speed we want him to move \u2013 so let\u2019s put that as an attribute so we can change it easily."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:'pc.script.attribute("speed", "number", 10);\npc.script.create(\'Santa_Controller\', function (context) {\n'})}),"\n",(0,o.jsx)(t.p,{children:"Now, let\u2019s make 2 functions \u2013 one that moves Santa up, and one that moves Santa down."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"    // Called every frame, dt is time in seconds since last update\n    update: function (dt) {\n    },\n\n    moveUp: function(dt) {\n        this.entity.translate(0, this.speed * dt, 0);\n    },\n\n    moveDown: function(dt) {\n        this.entity.translate(0, -this.speed * dt, 0);\n    }\n};\n"})}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.code,{children:"translate"})," function is one that all entities have, and simply moves the entity by a specified amount. In this case, we want Santa to move up or down by the speed, multiplied by the amount of time passed in the current frame. We do this so that Santa will move the same speed however fast our game is running!"]}),"\n",(0,o.jsx)(t.h2,{id:"keyboard-controls",children:"Keyboard Controls"}),"\n",(0,o.jsxs)(t.p,{children:["Now, let\u2019s look at keyboard controls. To do anything with the keyboard in PlayCanvas, we need to use ",(0,o.jsx)(t.code,{children:"context.keyboard"}),". ",(0,o.jsx)(t.code,{children:"context"})," is available in all scripts, and allows us access to all the data our game has to offer \u2013 in this case, we need the keyboard, which deals with keyboard input."]}),"\n",(0,o.jsxs)(t.p,{children:["We can use ",(0,o.jsx)(t.code,{children:"context.keyboard.isPressed"})," to check if specific keys are pressed \u2013 if W or S are pressed, we\u2019ll move Santa up or down accordingly. We\u2019ll need to check every frame, so put the following code in the update function:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"if (context.keyboard.isPressed(pc.input.KEY_W)) {\n    this.moveUp(dt);\n}\nif (context.keyboard.isPressed(pc.input.KEY_S)) {\n    this.moveDown(dt);\n}\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Before we test the game, however, there\u2019s something we need to do. The editor needs to be told when we add an attribute to a script, so back in the editor, and go ",(0,o.jsx)(t.em,{children:"Entity > Refresh Script Attributes"}),". A box should come up underneath our Santa_Controller.js script allowing us to change the speed of Santa."]}),"\n",(0,o.jsx)(t.p,{children:"Now test the game \u2013 we should be able to move Santa up and down now using the W and S keys! Change the speed in the editor until you find something that feels fun."}),"\n",(0,o.jsx)(t.h2,{id:"mouse-controls",children:"Mouse Controls"}),"\n",(0,o.jsx)(t.p,{children:"That\u2019s all good, however, we want the option of using the mouse or the keyboard! Let\u2019s add another attribute in our script that will allow us to change between mouse and keyboard when testing:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:'pc.script.attribute("keyboard", "boolean", true);\n'})}),"\n",(0,o.jsxs)(t.p,{children:["If you do ",(0,o.jsx)(t.em,{children:"Entity > Refresh Script Attributes"})," again, you\u2019ll see another attribute that we can change, and this time it\u2019s a check box. That\u2019s all a Boolean is \u2013 a true or a false value. Either off or on. If keyboard is ticked we\u2019ll use the keyboard input, and if it\u2019s not we\u2019ll use the mouse."]}),"\n",(0,o.jsxs)(t.p,{children:["To do things with the mouse in PlayCanvas, we have to use \u2013 you guessed it \u2013 ",(0,o.jsx)(t.code,{children:"context.mouse"}),"! Mouse input is going to be slightly more work than keyboard, but we\u2019ll be okay. We need to get the position of the mouse on screen, compare it to Santa\u2019s position, and move Santa towards the mouse."]}),"\n",(0,o.jsx)(t.p,{children:"So, we\u2019ll need a variable to store the mouse position, and we\u2019ll also need some way of getting the mouse position. For that, we\u2019ll need a listener."}),"\n",(0,o.jsx)(t.p,{children:"A listener is simply a function that we define, that gets called by a specific event. In this example, the event we want to \u201clisten\u201d for is the mouse moving."}),"\n",(0,o.jsx)(t.p,{children:"So, let\u2019s set this up:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"// Called once after all resources are loaded\ninitialize: function () {\n    //Used to store the mouse position\n    this.pos = new pc.Vec3();\n    context.mouse.on(pc.input.EVENT_MOUSEMOVE, this.onMouseMove, this);\n},\n"})}),"\n",(0,o.jsxs)(t.p,{children:["We\u2019ve got a variable called ",(0,o.jsx)(t.code,{children:"pos"})," that we\u2019ll store the current mouse position in. The next line is what creates our listener. We\u2019re saying when there\u2019s a mouse move event, we want a function called ",(0,o.jsx)(t.code,{children:"onMouseMove"})," to execute. Let\u2019s write that function now:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"moveDown: function(dt) {\n    this.entity.translate(0, -this.speed * dt, 0);\n},\n\nonMouseMove: function () {\n    // Use the camera component's screenToWorld function to convert the\n    // position of the mouse into a position in 3D space\n    var depth = 10;\n    var cameraEntity = context.root.findByName('Camera');\n    cameraEntity.camera.screenToWorld(event.x, event.y, depth, this.pos);\n}\n"})}),"\n",(0,o.jsxs)(t.p,{children:["In the ",(0,o.jsx)(t.code,{children:"onMouseMove"})," function, which gets called every time the mouse moves, we have to do some work to get the position we need. Because the mouse is only on a 2D screen, we have to look at use the camera\u2019s ",(0,o.jsx)(t.code,{children:"screenToWorld"})," function to get the position we want."]}),"\n",(0,o.jsxs)(t.p,{children:["Have a look at this ",(0,o.jsx)(t.a,{href:"https://developer.playcanvas.com/tutorials/mouse-input/",children:"mouse tutorial"})," if you want to know more about how this works!"]}),"\n",(0,o.jsxs)(t.p,{children:["Now we\u2019ve got the position of the mouse in ",(0,o.jsx)(t.code,{children:"this.pos"})," \u2013 we can use that to move Santa! Let\u2019s update our ",(0,o.jsx)(t.code,{children:"update"})," function:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"update: function (dt) {\n    if(this.keyboard) {\n        if(context.keyboard.isPressed(pc.input.KEY_W)) {\n            this.moveUp(dt);\n        }\n        if(context.keyboard.isPressed(pc.input.KEY_S)) {\n            this.moveDown(dt);\n        }\n    } else {\n        if(this.pos.y > this.entity.getPosition().y) {\n            this.moveUp(dt);\n        }\n        if(this.pos.y < this.entity.getPosition().y) {\n            this.moveDown(dt);\n        }\n    }\n},\n"})}),"\n",(0,o.jsx)(t.p,{children:"First things first - we now check to see if we\u2019re using keyboard or mouse. If we\u2019re using the keyboard, we do exactly what we did before \u2013 otherwise, we can use the mouse for input."}),"\n",(0,o.jsxs)(t.p,{children:["We have the mouse\u2019s position stored in ",(0,o.jsx)(t.code,{children:"this.pos"})," \u2013 now all we have to do is compare it to Santa\u2019s position. If the mouse is above Santa, we move him up, and if it\u2019s below, we move him down."]}),"\n",(0,o.jsx)(t.p,{children:"Test the game and we should be able to use either the keyboard or the mouse to move Santa, depending on whether or not you\u2019ve ticked the keyboard box!"}),"\n",(0,o.jsx)(t.p,{children:"That\u2019s all for this time \u2013 next time we\u2019ll look at adding presents for Santa to collect!"})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>r});var a=n(96540);const o={},s=a.createContext(o);function i(e){const t=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),a.createElement(s.Provider,{value:t},e.children)}},39914:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/playhack-santa-44751e4b1ac1ee058e934d48dd0453f3.jpg"},49773:e=>{e.exports=JSON.parse('{"permalink":"/playhack-december-player-character","editUrl":"https://github.com/playcanvas/blog/tree/main/blog/2014-12-08-playhack-december-player-character.md","source":"@site/blog/2014-12-08-playhack-december-player-character.md","title":"PLAYHACK December - Player Character","description":"**PLAYHACK** is our fun monthly game building session. Throughout the month I\'ll be posting tips and tricks to help you get a game made by the end of the month.\xa0Don\u2019t forget, these are just examples. You can make **any** game you like. Read more about this month\'s PLAYHACK.","date":"2014-12-08T00:00:00.000Z","tags":[],"readingTime":8.04,"hasTruncateMarker":true,"authors":[{"name":"Nathan Patel","title":"Technical Blogger","page":{"permalink":"/authors/nathan"},"socials":{"linkedin":"https://www.linkedin.com/in/nathan-patel-1b7539101/","github":"https://github.com/gnatpat"},"imageURL":"https://github.com/gnatpat.png","key":"nathan"}],"frontMatter":{"authors":"nathan","slug":"playhack-december-player-character","title":"PLAYHACK December - Player Character"},"unlisted":false,"prevItem":{"title":"PLAYCANVAS in LUDUM DARE 31","permalink":"/playcanvas-in-ludum-dare-31"},"nextItem":{"title":"PlayCanvas Update 5/12/14","permalink":"/playcanvas-update-51214"}}')},54080:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/editor-santa-67a77497d4a37e4e9528cf58743d54da.jpg"},87562:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/files/editor-santa-67a77497d4a37e4e9528cf58743d54da.jpg"}}]);